{% ckan_extends %}
{% import 'macros/form.html' as form %}
{% import 'macros/form_custom.html' as form_custom %}


{% block custom_fields %}

{{ form.markdown('source_names', id='field-source_names', label=_('Source Names'), placeholder=_('e.g., vendor-one'), value=data.source_names, error=errors.source_names) }}
{#{ form.input('source_names', label=_("Source Names"), placeholder="description of dataset sources", value=data.source_names, error=errors.source_names) }#}

{{ form.markdown('access_restrictions', id='field-access_restrictions', label=_('Access Restrictions'), placeholder=_(''), value=data.access_restrictions, error=errors.access_restrictions) }}

{% call form.input_block("field-constact_primary_name",_("Contact: Primary"), error="") %} {# this is just for clicking #}
    <input id="field-contact_primary_name" type="text" placeholder="enter last name, first name"  value="{{data.contact_primary_name}}" name="contact_primary_name" />
    <input id="field-contact_primary_email" type="email" placeholder="contact@domain.gov" value="{{data.contact_primary_email}}" name="contact_primary_email" />
{% endcall %}

{{ form.markdown('initial_purpose_for_intake', id='field-initial_purpose_for_intake', label=_('Initial Purpose for Intake'), placeholder=_(''), value=data.initial_purpose_for_intake, error=errors.initial_purpose_for_intake) }}

{{ form_custom.select_with_other('legal_authority_for_collection', 
label=_('Legal Authority for Collection'),  
current_values=h.clean_select_multi(data.get('legal_authority_for_collection', '')), 
options_defaults=h.options_legal_authority_for_collection(), 
error=errors.legal_authority_for_collection,
multiple=True) }}

{{ form.input('pra_omb_control_number', label=_("PRA: OMB Control Number"), placeholder="####-####", value=data.pra_omb_control_number, error=errors.pra_omb_control_number) }}

{{ form_custom.select_with_other('privacy_pia_title', 
label=_('Privacy: PIA Title'),  
current_values=h.clean_select_multi(data.get('privacy_pia_title', '')), 
options_defaults=h.options_privacy_pia_title(), 
error=errors.privacy_pia_title,
multiple=True) }}

<!-- privacy_sorn_number -- pick many: CFPB.#### + OTHER -- list in tab (format enforced) -->
{{ form_custom.select_with_other('privacy_sorn_number', 
label=_('Privacy: SORN number'),  
current_values=h.clean_select_multi(data.get('privacy_sorn_number', '')), 
options_defaults=h.options_privacy_sorn_number(), 
error=errors.privacy_sorn_number,
multiple=True) }}

<!-- relevant_governing_documents -- pick many  ["Contract", "MOU", "NDA", "Inter-agency Agreement"] + OTHER -->
{{ form_custom.select_with_other('relevant_governing_documents', 
label=_('Relevant Governing Documents'),  
current_values=h.clean_select_multi(data.get('relevant_governing_documents', '')), 
options_defaults=h.options_relevant_governing_documents(), 
error=errors.relevant_governing_documents,
multiple=True) }}

<!-- dig_id -- DI##### -- slug field? -->
{{ form.input('dig_id', label=_("DIG ID"), placeholder="DI#####", value=data.dig_id, error=errors.dig_id) }}

{{ form.markdown('usage_restrictions', id='field-usage_restrictions', 
label=_('Usage Restrictions'), placeholder=_(''), value=data.usage_restrictions, error=errors.usage_restrictions) }}

<!--------------------add-one to pick-1 list --------------------->
<!-- TO DO: add the jquery js to static -->
{# this uses jquery from http://stackoverflow.com/questions/1962041/jquery-dynamically-update-other-option-in-select
#}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
$(function() {
    $('select').change( function() { <!--select#type_of_entries-->
        var value = $(this).val();
        if (value == "__Other") {
           var custom = prompt( "Please enter custom value:" );
           if (!custom) return false;
           <!-- clear selections -->
           $(this).find($('option')).attr('selected',false)
           <!-- add and select new option -->
           $(this).prepend('<option value="' + custom + '" selected="selected">' + custom
                             + '</option>');
        }
    });
});
</script>
<hr>

{{ form_custom.radio('privacy_has_direct_identifiers', 
label=_('Privacy: Has Direct Identifiers'),
current_value=data.privacy_has_direct_identifiers)}}

{{ form_custom.radio('privacy_has_privacy_act_statement', 
label=_('Privacy: Has Privacy Act Statement'),
current_value=data.privacy_has_privacy_act_statement)}}


{{ form.input('transfer_initial_size', label=_("Transfer: Initial Size (mb)"), placeholder="eg 1.2", value=data.transfer_initial_size, error=errors.transfer_initial_size) }}

{% endblock %}
