{% ckan_extends %}
{% block resource_content %}
{% resource 'cfpb_extrafields/resrelated.js' %}
{{super()}}

{#
<script src="https://github.cfpb.gov/gist/leitners/e560a131d62d8bbe282f.js"></script>
resource_id {{ res.id }}; package_id {{ res.package_id }}
<dd>{{ h.get_action('dataset_follower_count', {'id': res.package_id }) }}</dd>
<dd>{{ h.get_action('dataset_follower_count', {'id': '239b3982-5c83-4a48-b9e0-f45474a90126' }) }}</dd>
<dd>{{ h.get_action('related_create', {'title': "hi", 'type':"Post", 'url':"http://www.google.com", 'dataset_id': res.package_id }) }}</dd>
#}
<h3> replace the info button with the ACE editor and a submit button </h3>
  <button type="button" data-module="resrelated"
          data-module-dataset_id="{{ res.package_id }}"
          data-module-resource_id="{{ res.id }}"
          data-module-resource_name="{{ res.name }}"
          data-module-html="resrelated.html"
          data-module-title="{{ _('Sensitivity Level') }}">
          <i class="icon-info-sign"></i>
  </button>

<h3> now provide a dropdown and show gists</h3>
{% resource 'cfpb_extrafields/listrelated.js' %}
  <div data-module="listrelated"
          data-module-dataset_id="{{ res.package_id }}"
          data-module-resource_id="{{ res.id }}"
          data-module-resource_name="{{ res.name }}"
          data-module-html="listrelated.html"
    </div>
<div class="w" id="listrelated">
  
 <!--   <div id="datasetid" data-dataset_id="{{ res.package_id }}" data-resource_id="{{ res.id }}"></div>-->
 {% resource 'cfpb_extrafields/select_gist.js' %}
    <!-- for js listening -->
    <div id="gistList"> 
      <!-- for select dropdown -->
      <div id="listrelated_output"></div> 
    </div>
  </div>
<div id="gistZone"></div> 
  
<!-- gist dropdown  -->
<!--
{#<p>
  <label for="gistList"><h2>Gists</h2></label>
  <select id="gistList">
    <option value="">Select a Gist</option>
    <option value="906758">Get a Twitter user's avatar using PHP</option>
    <option value="785770">How to PHP regex match an HTML document's title</option>
    <option value="785766">How to PHP regex match an HTML document's meta description</option>
  </select>
</p>#}
-->
{% endblock %}

{% block resource_additional_information %}
  
    {% if res %}
{{ res }}
      <section class="module">
        <div class="module-content">
          <h2>{{ _('Additional Information') }}</h2>
          <table class="table table-striped table-bordered table-condensed" data-module="table-toggle-more">
            <thead>
              <tr>
                <th scope="col">{{ _('Field') }}</th>
                <th scope="col">{{ _('Value') }}</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">{{ _('Metadata Resource ID') }}</th>
                <td>{{ res.id or _('unknown') }}</td>
              </tr>
              <tr>
                <th scope="row">{{ _('Metadata Resource Created') }}</th>
                <td>{{ h.render_datetime(res.created) or _('unknown') }}</td>
              </tr>
              <tr>
                <th scope="row">{{ _('Metadata Last updated') }}</th>
                <td>{{ h.render_datetime(res.last_modified) or h.render_datetime(res.revision_timestamp) or h.render_datetime(res.created) or _('unknown') }}</td>
              </tr>
              <tr>
                <th scope="row">{{ _('Format') }}</th>
                <td>{{ res.mimetype_inner or res.mimetype or res.format or _('unknown') }}</td>
              </tr>
              <!-- new core fields -->
              {% if res.content_temporal_range_end %}
              <tr>
	            <th scope="row" class="dataset-label">{{ _("Content: Temporal Range End") }} </th>
	            <td class="dataset-details">{{ res.content_temporal_range_end }} </td>
              </tr>
              {% endif %}
              {% if res.content_temporal_range_start %}
              <tr>
	            <th scope="row" class="dataset-label">{{ _("Content: Temporal Range Start") }} </th>
	            <td class="dataset-details">{{ res.content_temporal_range_start }} </td>
              </tr>
              {% endif %}
              {% if res.storage_location or res.storage_location_path %}
              <tr>
	            <th scope="row" class="dataset-label">{{ _("Storage Location") }} </th>
	            <td class="dataset-details">
                  <table style="width:100%"><tr><td>{{ res.storage_location }}</td>
                             <td>{{ res.storage_location_path }}</td>
                         </tr></table> </td>
              {% endif %}
              </tr>
              {% if res.sensitivity_level %}
              <tr>
	            <th scope="row" class="dataset-label">{{ _("Sensitivity Level") }} </th>
	            <td class="dataset-details">{{ res.sensitivity_level }} </td>
              </tr>
              {% endif %}
              {% if res.privacy_contains_pii %}
              <tr>
	            <th scope="row" class="dataset-label">{{ _("Privacy: Contains PII") }} </th>
	            <td class="dataset-details">{{ res.privacy_contains_pii}} </td>
              </tr>
              {% endif %}
              <tr>
                <th scope="row" class="dataset-label"><br> </th>
                <td class="dataset-details"><br> </td>
              </tr>
              {% if res.intake_date %} 
              <tr>
                <th scope="row" class="dataset-label">{{ _("Intake Date") }}</th>
                <td class="dataset-details">{{ res.intake_date }}</td>
              </tr>
              {% endif %}
              {% if res.update_size %} 
              <tr>
                <th scope="row" class="dataset-label">{{ _("Update: Size") }}</th>
                <td class="dataset-details">{{ res.update_size }}</td>
              </tr>
              {% endif %}
              {% if res.approximate_total_size %} 
              <tr>
                <th scope="row" class="dataset-label">{{ _("Approximate Total Size") }}</th>
                <td class="dataset-details">{{ res.approximate_total_size }}</td>
              </tr>
              {% endif %}
              {% if res.resource_type %} 
              <tr>
                <th scope="row" class="dataset-label">{{ _("Resource Type") }}</th>
                <td class="dataset-details">{{ res.resource_type }}</td>
              </tr>
              {% endif %}
              {% if res.privacy_has_direct_identifiers %} 
              <tr>
                <th scope="row" class="dataset-label">{{ _("Privacy: Has Direct Identifiers") }}</th>
                <td class="dataset-details">{{ res.privacy_has_direct_identifiers }}</td>
              </tr>
              {% endif %}
              {% if res.cleansing_rules_used %} 
              <tr>
                <th scope="row" class="dataset-label">{{ _("Cleansing Rules Used") }}</th>
                <td class="dataset-details">{{ res.cleansing_rules_used }}</td>
              </tr>
              {% endif %}
              
            </tbody>
          </table>
        </div>
      </section>

      <!--script src="https://github.cfpb.gov/gist/leitners/e560a131d62d8bbe282f.js"></script-->
      {% endif %}
{% endblock %}
